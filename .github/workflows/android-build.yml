name: Android Build (NDJC â€¢ Core-Templates minimal)

on:
  workflow_dispatch:
    inputs:
      run_id:
        description: "NDJC request run id (e.g. ndjc-20251217T193539Z)"
        required: true
        type: string

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
...

      - name: NDJC | Core-Templates assembly
        shell: bash
        run: |
          set -euo pipefail
          bash scripts/ndjc-assembly.sh

      - name: Install dependencies (if needed)
        shell: bash
        run: |
          set -euo pipefail
          if [ -f package.json ]; then
            corepack enable
            if [ -f pnpm-lock.yaml ]; then
              pnpm install --frozen-lockfile
            else
              pnpm install --no-frozen-lockfile
            fi
          else
            echo "No package.json, skip dependency install"
          fi

      - name: Set up JDK
        uses: actions/setup-java@v4
        with:
          distribution: "temurin"
          java-version: "17"

      - name: Build APK (Debug)
        shell: bash
        run: |
          set -euo pipefail
          ./gradlew :app:assembleDebug --no-daemon

      - name: Upload APK artifact
        uses: actions/upload-artifact@v4
        with:
          name: apk-debug
          path: app/build/outputs/apk/debug/*.apk
          if-no-files-found: error
          retention-days: 14
